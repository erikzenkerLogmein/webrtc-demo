!function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){e.exports=n(1)},function(e,t,n){"use strict";function o(){}n.r(t);function i(e,t,n,o,i){e.__svelte_meta={loc:{file:t,line:n,column:o,char:i}}}function c(e){return e()}function r(){return Object.create(null)}function s(e){e.forEach(c)}function a(e){return"function"==typeof e}function l(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function u(e){return 0===Object.keys(e).length}function d(e,t){if(null!=e&&"function"!=typeof e.subscribe)throw new Error(`'${t}' is not a store with a 'subscribe' method`)}function f(e,...t){if(null==e)return o;const n=e.subscribe(...t);return n.unsubscribe?()=>n.unsubscribe():n}function p(e,t,n){e.$$.on_destroy.push(f(t,n))}new Set;let m=!1;function h(e,t,n,o){for(;e<t;){const i=e+(t-e>>1);n(i)<=o?e=i+1:t=i}return e}function g(e,t){m?(!function(e){if(e.hydrate_init)return;e.hydrate_init=!0;const t=e.childNodes,n=new Int32Array(t.length+1),o=new Int32Array(t.length);n[0]=-1;let i=0;for(let e=0;e<t.length;e++){const c=h(1,i+1,e=>t[n[e]].claim_order,t[e].claim_order)-1;o[e]=n[c]+1;const r=c+1;n[r]=e,i=Math.max(r,i)}const c=[],r=[];let s=t.length-1;for(let e=n[i]+1;0!=e;e=o[e-1]){for(c.push(t[e-1]);s>=e;s--)r.push(t[s]);s--}for(;s>=0;s--)r.push(t[s]);c.reverse(),r.sort((e,t)=>e.claim_order-t.claim_order);for(let t=0,n=0;t<r.length;t++){for(;n<c.length&&r[t].claim_order>=c[n].claim_order;)n++;const o=n<c.length?c[n]:null;e.insertBefore(r[t],o)}}(e),(void 0===e.actual_end_child||null!==e.actual_end_child&&e.actual_end_child.parentElement!==e)&&(e.actual_end_child=e.firstChild),t!==e.actual_end_child?e.insertBefore(t,e.actual_end_child):e.actual_end_child=t.nextSibling):t.parentNode!==e&&e.appendChild(t)}function v(e,t,n){m&&!n?g(e,t):(t.parentNode!==e||n&&t.nextSibling!==n)&&e.insertBefore(t,n||null)}function $(e){e.parentNode.removeChild(e)}function w(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function b(e){return document.createElement(e)}function y(e){return document.createTextNode(e)}function k(){return y(" ")}function S(){return y("")}function C(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function x(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function R(e,t){e.value=null==t?"":t}function _(e,t,n){e.classList[n?"add":"remove"](t)}function O(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}new Set;let E;function j(e){E=e}function D(){if(!E)throw new Error("Function called outside component initialization");return E}function M(e){D().$$.on_mount.push(e)}function B(){const e=D();return(t,n)=>{const o=e.$$.callbacks[t];if(o){const i=O(t,n);o.slice().forEach(t=>{t.call(e,i)})}}}const A=[],P=[],N=[],L=[],U=Promise.resolve();let T=!1;function I(){T||(T=!0,U.then(H))}function F(){return I(),U}function q(e){N.push(e)}let J=!1;const V=new Set;function H(){if(!J){J=!0;do{for(let e=0;e<A.length;e+=1){const t=A[e];j(t),W(t.$$)}for(j(null),A.length=0;P.length;)P.pop()();for(let e=0;e<N.length;e+=1){const t=N[e];V.has(t)||(V.add(t),t())}N.length=0}while(A.length);for(;L.length;)L.pop()();T=!1,J=!1,V.clear()}}function W(e){if(null!==e.fragment){e.update(),s(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(q)}}const z=new Set;let Y;function G(){Y={r:0,c:[],p:Y}}function K(){Y.r||s(Y.c),Y=Y.p}function Q(e,t){e&&e.i&&(z.delete(e),e.i(t))}function X(e,t,n,o){if(e&&e.o){if(z.has(e))return;z.add(e),Y.c.push(()=>{z.delete(e),o&&(n&&e.d(1),o())}),e.o(t)}}const Z="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;new Set(["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"]);let ee;function te(e){e&&e.c()}function ne(e,t,n,o){const{fragment:i,on_mount:r,on_destroy:l,after_update:u}=e.$$;i&&i.m(t,n),o||q(()=>{const t=r.map(c).filter(a);l?l.push(...t):s(t),e.$$.on_mount=[]}),u.forEach(q)}function oe(e,t){const n=e.$$;null!==n.fragment&&(s(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function ie(e,t,n,i,c,a,l=[-1]){const u=E;j(e);const d=e.$$={fragment:null,ctx:null,props:a,update:o,not_equal:c,bound:r(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(u?u.$$.context:t.context||[]),callbacks:r(),dirty:l,skip_bound:!1};let f=!1;if(d.ctx=n?n(e,t.props||{},(t,n,...o)=>{const i=o.length?o[0]:n;return d.ctx&&c(d.ctx[t],d.ctx[t]=i)&&(!d.skip_bound&&d.bound[t]&&d.bound[t](i),f&&function(e,t){-1===e.$$.dirty[0]&&(A.push(e),I(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}(e,t)),n}):[],d.update(),f=!0,s(d.before_update),d.fragment=!!i&&i(d.ctx),t.target){if(t.hydrate){m=!0;const e=(p=t.target,Array.from(p.childNodes));d.fragment&&d.fragment.l(e),e.forEach($)}else d.fragment&&d.fragment.c();t.intro&&Q(e.$$.fragment),ne(e,t.target,t.anchor,t.customElement),m=!1,H()}var p;j(u)}"function"==typeof HTMLElement&&(ee=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const{on_mount:e}=this.$$;this.$$.on_disconnect=e.map(c).filter(a);for(const e in this.$$.slotted)this.appendChild(this.$$.slotted[e])}attributeChangedCallback(e,t,n){this[e]=n}disconnectedCallback(){s(this.$$.on_disconnect)}$destroy(){oe(this,1),this.$destroy=o}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){this.$$set&&!u(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}});function ce(e,t){document.dispatchEvent(O(e,Object.assign({version:"3.38.3"},t)))}function re(e,t){ce("SvelteDOMInsert",{target:e,node:t}),g(e,t)}function se(e,t,n){ce("SvelteDOMInsert",{target:e,node:t,anchor:n}),v(e,t,n)}function ae(e){ce("SvelteDOMRemove",{node:e}),$(e)}function le(e,t,n,o,i,c){const r=!0===o?["capture"]:o?Array.from(Object.keys(o)):[];i&&r.push("preventDefault"),c&&r.push("stopPropagation"),ce("SvelteDOMAddEventListener",{node:e,event:t,handler:n,modifiers:r});const s=C(e,t,n,o);return()=>{ce("SvelteDOMRemoveEventListener",{node:e,event:t,handler:n,modifiers:r}),s()}}function ue(e,t,n){x(e,t,n),null==n?ce("SvelteDOMRemoveAttribute",{node:e,attribute:t}):ce("SvelteDOMSetAttribute",{node:e,attribute:t,value:n})}function de(e,t){t=""+t,e.wholeText!==t&&(ce("SvelteDOMSetData",{node:e,data:t}),e.data=t)}function fe(e){if(!("string"==typeof e||e&&"object"==typeof e&&"length"in e)){let t="{#each} only iterates over array-like objects.";throw"function"==typeof Symbol&&e&&Symbol.iterator in e&&(t+=" You can use a spread to convert this iterable into an array."),new Error(t)}}function pe(e,t,n){for(const o of Object.keys(t))~n.indexOf(o)||console.warn(`<${e}> received an unexpected slot "${o}".`)}class me extends class{$destroy(){oe(this,1),this.$destroy=o}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){this.$$set&&!u(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}{constructor(e){if(!e||!e.target&&!e.$$inline)throw new Error("'target' is a required option");super()}$destroy(){super.$destroy(),this.$destroy=()=>{console.warn("Component was already destroyed")}}$capture_state(){}$inject_state(){}}const he=[];function ge(e,t=o){let n;const i=[];function c(t){if(l(e,t)&&(e=t,n)){const t=!he.length;for(let t=0;t<i.length;t+=1){const n=i[t];n[1](),he.push(n,e)}if(t){for(let e=0;e<he.length;e+=2)he[e][0](he[e+1]);he.length=0}}}return{set:c,update:function(t){c(t(e))},subscribe:function(r,s=o){const a=[r,s];return i.push(a),1===i.length&&(n=t(c)||o),r(e),()=>{const e=i.indexOf(a);-1!==e&&i.splice(e,1),0===i.length&&(n(),n=null)}}}}function ve(e,t,n){const i=!Array.isArray(e),c=i?[e]:e,r=t.length<2;return{subscribe:ge(n,e=>{let n=!1;const l=[];let u=0,d=o;const p=()=>{if(u)return;d();const n=t(i?l[0]:l,e);r?e(n):d=a(n)?n:o},m=c.map((e,t)=>f(e,e=>{l[t]=e,u&=~(1<<t),n&&p()},()=>{u|=1<<t}));return n=!0,p(),function(){s(m),d()}}).subscribe}}const $e=ge([]),we=e=>{try{return!0===JSON.parse(e)}catch{return!1}},be=ge((()=>{const e=Object.fromEntries(new URLSearchParams(location.search).entries()),t={role:e.role||"both",stream:e.stream||"both",manual:we(e.manual),remote:we(e.remote),hideDetails:we(e.hideDetails)};return Object.entries(t).map(([e,t])=>({key:e,value:t}))})()),ye=ve(be,e=>`${window.location.protocol}//${window.location.host}/?${(e=>{const t=new URLSearchParams;for(let[n,o]of e)t.set(n,o);return t.toString()})(e.map(({key:e,value:t})=>[e,t]))}`),ke=ve(be,e=>{const t=Object.fromEntries(e.map(({key:e,value:t})=>[e,t]));let{role:n,stream:o,manual:i,remote:c,hideDetails:r}=t;const s="recv"!==n,a="call"!==n&&"send"!==n||!1,l="down"!==o||!1,u="up"!==o||!1,d=i&&"no"!==i||!1,f=c&&"no"!==c||!1,p=s?"bob":"alice",m=a?"bob":"alice";return{...t,role:n,stream:o,manual:i,remote:c,hasCaller:s,hasReceiver:a,hasUpstream:l,hasDownstream:u,isManual:d,isRemote:f,hideDetails:r,to:p,from:m}}),Se=ge({});const Ce=e=>(t,n)=>function(e,t,n){const o={name:e,short:t,event:n};$e.update(e=>[...e,o]),Se.update(n=>({...n,[e]:[...n[e]||[],t]}))}(e,t,n),xe=ge({}),Re=ge({}),_e=ge({});function Oe({from:e,offer:t}){xe.update(n=>({...n,[e]:t}))}function Ee({from:e,answer:t}){Re.update(n=>({...n,[e]:t}))}function je({from:e,candidate:t}){_e.update(n=>{const o=n[e]||[];return{...n,[e]:[...o,t]}})}function De({from:e}){_e.update(t=>({...t,[e]:[]}))}const Me="src/Config.svelte";function Be(e,t,n){const o=e.slice();return o[6]=t[n].key,o[7]=t[n].value,o[8]=t,o[9]=n,o}function Ae(e){let t,n,o;function c(){e[3].call(t,e[8],e[9])}const r={c:function(){t=b("input"),ue(t,"type","text"),i(t,Me,33,12,774)},m:function(i,r){se(i,t,r),R(t,e[7]),n||(o=le(t,"input",c),n=!0)},p:function(n,o){e=n,2&o&&t.value!==e[7]&&R(t,e[7])},d:function(e){e&&ae(t),n=!1,o()}};return ce("SvelteRegisterBlock",{block:r,id:Ae.name,type:"else",source:"(33:12) {:else}",ctx:e}),r}function Pe(e){let t,n,o;function c(){e[2].call(t,e[8],e[9])}const r={c:function(){t=b("input"),ue(t,"type","checkbox"),i(t,Me,31,12,696)},m:function(i,r){se(i,t,r),t.checked=e[7],n||(o=le(t,"change",c),n=!0)},p:function(n,o){e=n,2&o&&(t.checked=e[7])},d:function(e){e&&ae(t),n=!1,o()}};return ce("SvelteRegisterBlock",{block:r,id:Pe.name,type:"if",source:"(31:12) {#if typeof value === 'boolean'}",ctx:e}),r}function Ne(e){let t,n,o,c,r,s,a=e[6]+"";function l(e,t){return"boolean"==typeof e[7]?Pe:Ae}let u=l(e),d=u(e);const f={c:function(){t=b("tr"),n=b("td"),o=y(a),c=k(),r=b("td"),d.c(),s=k(),i(n,Me,28,12,607),i(r,Me,29,12,634),i(t,Me,27,8,590)},m:function(e,i){se(e,t,i),re(t,n),re(n,o),re(t,c),re(t,r),d.m(r,null),re(t,s)},p:function(e,t){2&t&&a!==(a=e[6]+"")&&de(o,a),u===(u=l(e))&&d?d.p(e,t):(d.d(1),d=u(e),d&&(d.c(),d.m(r,null)))},d:function(e){e&&ae(t),d.d()}};return ce("SvelteRegisterBlock",{block:f,id:Ne.name,type:"each",source:"(27:4) {#each $query as {key, value}",ctx:e}),f}function Le(e){let t,n,c,r,s,a,l,u,d,f=e[1];fe(f);let p=[];for(let t=0;t<f.length;t+=1)p[t]=Ne(Be(e,f,t));const m={c:function(){t=b("details"),n=b("summary"),n.textContent="config",c=k(),r=b("code"),s=b("pre"),a=b("a"),l=y(e[0]),u=k(),d=b("table");for(let e=0;e<p.length;e+=1)p[e].c();i(n,Me,20,4,428),ue(a,"href",e[0]),i(a,Me,22,4,474),i(s,Me,21,10,464),ue(r,"class","svelte-12ii7jf"),i(r,Me,21,4,458),i(d,Me,25,4,536),i(t,Me,19,0,414)},l:function(e){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(e,o){se(e,t,o),re(t,n),re(t,c),re(t,r),re(r,s),re(s,a),re(a,l),re(t,u),re(t,d);for(let e=0;e<p.length;e+=1)p[e].m(d,null)},p:function(e,[t]){if(1&t&&de(l,e[0]),1&t&&ue(a,"href",e[0]),2&t){let n;for(f=e[1],fe(f),n=0;n<f.length;n+=1){const o=Be(e,f,n);p[n]?p[n].p(o,t):(p[n]=Ne(o),p[n].c(),p[n].m(d,null))}for(;n<p.length;n+=1)p[n].d(1);p.length=f.length}},i:o,o:o,d:function(e){e&&ae(t),w(p,e)}};return ce("SvelteRegisterBlock",{block:m,id:Le.name,type:"component",source:"",ctx:e}),m}function Ue(e,t,n){let o,i;d(ye,"configUrl"),p(e,ye,e=>n(0,o=e)),d(be,"query"),p(e,be,e=>n(1,i=e));let{$$slots:c={},$$scope:r}=t;pe("Config",c,[]);const s=e=>{try{return"boolean"===JSON.parse(e)}catch{return!1}},a=({target:{value:e,name:t}})=>{ke.update(n=>({...n,[t]:"on"===e}))},l=[];return Object.keys(t).forEach(e=>{~l.indexOf(e)||"$$"===e.slice(0,2)||console.warn(`<Config> was created with unknown prop '${e}'`)}),e.$capture_state=()=>({query:be,config:ke,configUrl:ye,eventLog:$e,boolable:s,checkConfig:a,$configUrl:o,$query:i}),[o,i,function(e,t){e[t].value=this.checked,be.set(i)},function(e,t){e[t].value=this.value,be.set(i)}]}var Te=class extends me{constructor(e){super(e),ie(this,e,Ue,Le,l,{}),ce("SvelteRegisterComponent",{component:this,tagName:"Config",options:e,id:Le.name})}};class Ie{constructor({to:e,from:t}){this.to=e,this.from=t}connect({url:e}){this.url=e;const t=new WebSocket(e);t.onopen=()=>{this.socket=t,this.socket.onmessage=this.received.bind(this)}}received({data:e}){const t=JSON.parse(e),{[this.to]:n,type:o}=t;console.debug("its for me!",n);const i=this.to;switch(o){case"offer":Oe({from:i,offer:n});break;case"answer":Ee({from:i,answer:n});break;case"candidate":je({from:i,candidate:new RTCIceCandidate(n)})}}sendOffer(e){if(e){const t={[this.from]:e,type:"offer"};this.send(t)}}sendAnswer(e){if(e){const t={[this.from]:e,type:"answer"};this.send(t)}}sendCandidate(e){if(e){const t={[this.from]:e,type:"candidate"};this.send(t)}}send(e){if(this.socket){const t=JSON.stringify(e);this.socket.send(t)}}toString(){return`[Signaling Server calling ${this.from} → ${this.to}]`}}const Fe=e=>"string"==typeof e?JSON.parse(e).sdp:"object"==typeof e?e.sdp:void 0,qe=e=>{try{return JSON.parse(e)}catch(t){return""!==e&&console.warn({parseError:t}),[]}},Je=e=>({type:"offer",sdp:e}),Ve=e=>({type:"answer",sdp:e}),{Object:He,console:We}=Z;function ze(e){let t,n,c,r,a,l,u,d,f,p,m,h,g,v,$,w,S;const C={c:function(){t=b("label"),t.textContent="upstream",n=k(),c=b("video"),r=k(),a=b("nav"),l=b("button"),l.textContent="start upstream",u=k(),d=b("span"),f=b("label"),p=b("input"),m=y("\n            webcam"),h=k(),g=b("label"),v=b("input"),$=y("\n            noise"),ue(t,"for","upstream"),i(t,"src/Upstream.svelte",50,0,1442),ue(c,"id","upstream"),c.autoplay="true",ue(c,"width","400"),ue(c,"height","300"),ue(c,"class","svelte-v4j238"),i(c,"src/Upstream.svelte",51,0,1481),i(l,"src/Upstream.svelte",54,4,1583),ue(p,"type","radio"),p.__value=Ye,p.value=p.__value,e[5][0].push(p),i(p,"src/Upstream.svelte",57,12,1679),i(f,"src/Upstream.svelte",56,8,1659),ue(v,"type","radio"),v.__value=Ge,v.value=v.__value,e[5][0].push(v),i(v,"src/Upstream.svelte",62,12,1817),i(g,"src/Upstream.svelte",61,8,1797),i(d,"src/Upstream.svelte",55,4,1644),ue(a,"class","svelte-v4j238"),i(a,"src/Upstream.svelte",52,0,1572)},l:function(e){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(o,i){se(o,t,i),se(o,n,i),se(o,c,i),e[3](c),se(o,r,i),se(o,a,i),re(a,l),re(a,u),re(a,d),re(d,f),re(f,p),p.checked=p.__value===e[0],re(f,m),re(d,h),re(d,g),re(g,v),v.checked=v.__value===e[0],re(g,$),w||(S=[le(l,"click",e[2],!1,!1,!1),le(p,"change",e[4]),le(v,"change",e[6])],w=!0)},p:function(e,[t]){1&t&&(p.checked=p.__value===e[0]),1&t&&(v.checked=v.__value===e[0])},i:o,o:o,d:function(o){o&&ae(t),o&&ae(n),o&&ae(c),e[3](null),o&&ae(r),o&&ae(a),e[5][0].splice(e[5][0].indexOf(p),1),e[5][0].splice(e[5][0].indexOf(v),1),w=!1,s(S)}};return ce("SvelteRegisterBlock",{block:C,id:ze.name,type:"component",source:"",ctx:e}),C}async function Ye(){return await navigator.mediaDevices.getUserMedia({video:!0})}function Ge(){let e=Object.assign(document.createElement("canvas"),{width:400,height:300}),t=e.getContext("2d");t.fillRect(0,0,e.width,e.height);let n=t.getImageData(0,0,e.width,e.height);return requestAnimationFrame((function e(){for(var o=0;o<n.data.length;o++)n.data[o++]=n.data[o++]=n.data[o++]=255*Math.random();t.putImageData(n,0,0),requestAnimationFrame(e)})),e.captureStream(60)}function Ke(e,t,n){let{$$slots:o={},$$scope:i}=t;pe("Upstream",o,[]);const c=B();let r,s=Ye;async function a(){const e=await s();console.debug({stream:e}),n(1,r.srcObject=e,r),c("stream",e)}M(()=>{});const l=[];He.keys(t).forEach(e=>{~l.indexOf(e)||"$$"===e.slice(0,2)||We.warn(`<Upstream> was created with unknown prop '${e}'`)});return e.$capture_state=()=>({onMount:M,createEventDispatcher:B,dispatch:c,upstreamSource:s,upstreamVideo:r,getWebcamFeed:Ye,getNoiseFeed:Ge,startUpstream:a}),e.$inject_state=e=>{"upstreamSource"in e&&n(0,s=e.upstreamSource),"upstreamVideo"in e&&n(1,r=e.upstreamVideo)},t&&"$$inject"in t&&e.$inject_state(t.$$inject),[s,r,a,function(e){P[e?"unshift":"push"](()=>{r=e,n(1,r)})},function(){s=this.__value,n(0,s)},[[]],function(){s=this.__value,n(0,s)}]}var Qe=class extends me{constructor(e){super(e),ie(this,e,Ke,ze,l,{}),ce("SvelteRegisterComponent",{component:this,tagName:"Upstream",options:e,id:ze.name})}};function Xe(e){let t,n,c,r,a,l,u;const d={c:function(){t=b("form"),n=b("input"),c=k(),r=b("code"),a=y(e[0]),ue(n,"size","90"),ue(n,"placeholder","ws url"),i(n,"src/RemoteBar.svelte",18,4,498),i(t,"src/RemoteBar.svelte",17,0,451),i(r,"src/RemoteBar.svelte",21,0,576)},l:function(e){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(o,i){var s;se(o,t,i),re(t,n),R(n,e[1]),se(o,c,i),se(o,r,i),re(r,a),l||(u=[le(n,"input",e[2]),le(t,"submit",(s=Ze,function(e){return e.preventDefault(),s.call(this,e)}),!1,!0,!1)],l=!0)},p:function(e,[t]){2&t&&n.value!==e[1]&&R(n,e[1]),1&t&&de(a,e[0])},i:o,o:o,d:function(e){e&&ae(t),e&&ae(c),e&&ae(r),l=!1,s(u)}};return ce("SvelteRegisterBlock",{block:d,id:Xe.name,type:"component",source:"",ctx:e}),d}function Ze(){}function et(e,t,n){let o,{$$slots:i={},$$scope:c}=t;pe("RemoteBar",i,[]);let{signalingClient:r}=t;const s=["signalingClient"];return Object.keys(t).forEach(e=>{~s.indexOf(e)||"$$"===e.slice(0,2)||console.warn(`<RemoteBar> was created with unknown prop '${e}'`)}),e.$$set=e=>{"signalingClient"in e&&n(0,r=e.signalingClient)},e.$capture_state=()=>({offerStore:xe,answerStore:Re,candidatesStore:_e,config:ke,signalingClient:r,onSubmit:Ze,signalingServer:o}),e.$inject_state=e=>{"signalingClient"in e&&n(0,r=e.signalingClient),"signalingServer"in e&&n(1,o=e.signalingServer)},t&&"$$inject"in t&&e.$inject_state(t.$$inject),e.$$.update=()=>{3&e.$$.dirty&&(r.connect({url:o}),window.client=r)},n(1,o=`wss://${window.location.host}/signaling/test`),[r,o,function(){o=this.value,n(1,o)}]}var tt=class extends me{constructor(e){super(e),ie(this,e,et,Xe,l,{signalingClient:0}),ce("SvelteRegisterComponent",{component:this,tagName:"RemoteBar",options:e,id:Xe.name});const{ctx:t}=this.$$,n=e.props||{};void 0!==t[0]||"signalingClient"in n||console.warn("<RemoteBar> was created without expected prop 'signalingClient'")}get signalingClient(){throw new Error("<RemoteBar>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set signalingClient(e){throw new Error("<RemoteBar>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}};const{console:nt}=Z,ot="src/Participant.svelte";function it(e){let t,n;t=new tt({props:{signalingClient:e[20]},$$inline:!0});const i={c:function(){te(t.$$.fragment)},m:function(e,o){ne(t,e,o),n=!0},p:o,i:function(e){n||(Q(t.$$.fragment,e),n=!0)},o:function(e){X(t.$$.fragment,e),n=!1},d:function(e){oe(t,e)}};return ce("SvelteRegisterBlock",{block:i,id:it.name,type:"if",source:"(274:4) {#if $config.isRemote}",ctx:e}),i}function ct(e){let t,n,c;n=new Qe({$$inline:!0}),n.$on("stream",e[33]);const r={c:function(){t=b("div"),te(n.$$.fragment),ue(t,"id","upstream"),ue(t,"class","svelte-2kh684"),i(t,ot,280,12,8288)},m:function(e,o){se(e,t,o),ne(n,t,null),c=!0},p:o,i:function(e){c||(Q(n.$$.fragment,e),c=!0)},o:function(e){X(n.$$.fragment,e),c=!1},d:function(e){e&&ae(t),oe(n)}};return ce("SvelteRegisterBlock",{block:r,id:ct.name,type:"if",source:"(280:8) {#if $config.hasUpstream}",ctx:e}),r}function rt(e){let t,n,c,r;const s={c:function(){t=b("div"),n=b("label"),n.textContent="downstream",c=k(),r=b("video"),ue(n,"for","downstream"),i(n,ot,287,16,8511),r.autoplay="true",ue(r,"width","400"),ue(r,"height","300"),ue(r,"class","svelte-2kh684"),i(r,ot,288,16,8570),ue(t,"id","downstream"),ue(t,"class","svelte-2kh684"),i(t,ot,286,12,8473)},m:function(o,i){se(o,t,i),re(t,n),re(t,c),re(t,r),e[34](r)},p:o,d:function(n){n&&ae(t),e[34](null)}};return ce("SvelteRegisterBlock",{block:s,id:rt.name,type:"if",source:"(286:8) {#if $config.hasDownstream}",ctx:e}),s}function st(e){let t,n,o=e[14].join(",")+"";const c={c:function(){t=b("small"),n=y(o),i(t,ot,298,12,8966)},m:function(e,o){se(e,t,o),re(t,n)},p:function(e,t){16384&t[0]&&o!==(o=e[14].join(",")+"")&&de(n,o)},d:function(e){e&&ae(t)}};return ce("SvelteRegisterBlock",{block:c,id:st.name,type:"if",source:"(298:12) {#if !hideDetails}",ctx:e}),c}function at(e){let t,n,o,c,r,s,a,l,u,d=e[10]&&lt(e),f=e[16]&&!e[5].isManual&&ut(e),p=e[5].isManual&&dt(e);const m={c:function(){t=b("label"),n=y("1. "),o=b("button"),o.textContent="create offer",c=k(),d&&d.c(),r=k(),f&&f.c(),s=k(),p&&p.c(),a=S(),i(o,ot,310,27,9467),i(t,ot,310,16,9456)},m:function(i,m){se(i,t,m),re(t,n),re(t,o),se(i,c,m),d&&d.m(i,m),se(i,r,m),f&&f.m(i,m),se(i,s,m),p&&p.m(i,m),se(i,a,m),l||(u=le(o,"click",e[22],!1,!1,!1),l=!0)},p:function(e,t){e[10]?d?d.p(e,t):(d=lt(e),d.c(),d.m(r.parentNode,r)):d&&(d.d(1),d=null),e[16]&&!e[5].isManual?f?f.p(e,t):(f=ut(e),f.c(),f.m(s.parentNode,s)):f&&(f.d(1),f=null),e[5].isManual?p?p.p(e,t):(p=dt(e),p.c(),p.m(a.parentNode,a)):p&&(p.d(1),p=null)},d:function(e){e&&ae(t),e&&ae(c),d&&d.d(e),e&&ae(r),f&&f.d(e),e&&ae(s),p&&p.d(e),e&&ae(a),l=!1,u()}};return ce("SvelteRegisterBlock",{block:m,id:at.name,type:"if",source:"(310:12) {#if isCaller}",ctx:e}),m}function lt(e){let t,n,o,c,r,a,l,u,d,f,p,m;const h={c:function(){t=b("div"),n=b("textarea"),o=k(),c=b("br"),r=k(),a=b("label"),l=y("2.\n                            "),u=b("button"),u.textContent="setLocalDescription",d=k(),f=b("button"),f.textContent="send offer",ue(n,"cols","60"),ue(n,"rows","20"),ue(n,"class","svelte-2kh684"),_(n,"hideDetails",e[19]),i(n,ot,314,24,9616),i(c,ot,315,24,9718),i(u,ot,318,28,9816),i(f,ot,319,28,9935),i(a,ot,316,24,9749),i(t,ot,313,20,9586)},m:function(i,s){se(i,t,s),re(t,n),R(n,e[10]),re(t,o),re(t,c),re(t,r),re(t,a),re(a,l),re(a,u),re(a,d),re(a,f),p||(m=[le(n,"input",e[38]),le(u,"click",e[39],!1,!1,!1),le(f,"click",e[24],!1,!1,!1)],p=!0)},p:function(e,t){1024&t[0]&&R(n,e[10]),524288&t[0]&&_(n,"hideDetails",e[19])},d:function(e){e&&ae(t),p=!1,s(m)}};return ce("SvelteRegisterBlock",{block:h,id:lt.name,type:"if",source:"(313:16) {#if localOfferSdp}",ctx:e}),h}function ut(e){let t,n,o,c,r,a,l,u,d,f;const p={c:function(){t=b("div"),n=b("textarea"),o=k(),c=b("br"),r=k(),a=b("label"),l=y("5. "),u=b("button"),u.textContent="setRemoteDescription",ue(n,"cols","60"),ue(n,"rows","20"),ue(n,"class","svelte-2kh684"),_(n,"hideDetails",e[19]),i(n,ot,325,24,10174),i(c,ot,326,24,10277),i(u,ot,328,31,10347),i(a,ot,327,24,10308),i(t,ot,324,20,10144)},m:function(i,s){se(i,t,s),re(t,n),R(n,e[16]),re(t,o),re(t,c),re(t,r),re(t,a),re(a,l),re(a,u),d||(f=[le(n,"input",e[40]),le(u,"click",e[41],!1,!1,!1)],d=!0)},p:function(e,t){65536&t[0]&&R(n,e[16]),524288&t[0]&&_(n,"hideDetails",e[19])},d:function(e){e&&ae(t),d=!1,s(f)}};return ce("SvelteRegisterBlock",{block:p,id:ut.name,type:"if",source:"(324:16) {#if receivedAnswer && !$config.isManual}",ctx:e}),p}function dt(e){let t,n,o,c,r,a,l,u,d,f,p,m;const h={c:function(){t=b("div"),n=b("strong"),n.textContent="MANUAL ANSWER HERE",o=k(),c=b("textarea"),r=k(),a=b("br"),l=k(),u=b("label"),d=y("5. "),f=b("button"),f.textContent="setRemoteDescription",i(n,ot,334,24,10607),ue(c,"cols","60"),ue(c,"rows","20"),ue(c,"class","svelte-2kh684"),i(c,ot,335,24,10667),i(a,ot,336,24,10752),i(f,ot,338,31,10822),i(u,ot,337,24,10783),i(t,ot,333,20,10577)},m:function(i,s){se(i,t,s),re(t,n),re(t,o),re(t,c),R(c,e[13]),re(t,r),re(t,a),re(t,l),re(t,u),re(u,d),re(u,f),p||(m=[le(c,"input",e[42]),le(f,"click",e[43],!1,!1,!1)],p=!0)},p:function(e,t){8192&t[0]&&R(c,e[13])},d:function(e){e&&ae(t),p=!1,s(m)}};return ce("SvelteRegisterBlock",{block:h,id:dt.name,type:"if",source:"(333:16) {#if $config.isManual}",ctx:e}),h}function ft(e){let t,n,o,i=e[15]&&!e[5].isManual&&pt(e),c=e[5].isManual&&mt(e),r=e[11]&&e[15]&&ht(e);const s={c:function(){i&&i.c(),t=k(),c&&c.c(),n=k(),r&&r.c(),o=S()},m:function(e,s){i&&i.m(e,s),se(e,t,s),c&&c.m(e,s),se(e,n,s),r&&r.m(e,s),se(e,o,s)},p:function(e,s){e[15]&&!e[5].isManual?i?i.p(e,s):(i=pt(e),i.c(),i.m(t.parentNode,t)):i&&(i.d(1),i=null),e[5].isManual?c?c.p(e,s):(c=mt(e),c.c(),c.m(n.parentNode,n)):c&&(c.d(1),c=null),e[11]&&e[15]?r?r.p(e,s):(r=ht(e),r.c(),r.m(o.parentNode,o)):r&&(r.d(1),r=null)},d:function(e){i&&i.d(e),e&&ae(t),c&&c.d(e),e&&ae(n),r&&r.d(e),e&&ae(o)}};return ce("SvelteRegisterBlock",{block:s,id:ft.name,type:"if",source:"(345:12) {#if isReceiver}",ctx:e}),s}function pt(e){let t,n,o,c,r,a,l,u,d,f,p,m;const h={c:function(){t=b("div"),n=b("textarea"),o=k(),c=b("br"),r=k(),a=b("label"),l=y("3.\n                            "),u=b("button"),u.textContent="setRemoteDescription",d=k(),f=b("button"),f.textContent="create answer",ue(n,"cols","60"),ue(n,"rows","20"),ue(n,"class","svelte-2kh684"),_(n,"hideDetails",e[19]),i(n,ot,347,24,11148),i(c,ot,348,24,11250),i(u,ot,351,28,11348),i(f,ot,352,28,11463),i(a,ot,349,24,11281),i(t,ot,346,20,11118)},m:function(i,s){se(i,t,s),re(t,n),R(n,e[15]),re(t,o),re(t,c),re(t,r),re(t,a),re(a,l),re(a,u),re(a,d),re(a,f),p||(m=[le(n,"input",e[44]),le(u,"click",e[45],!1,!1,!1),le(f,"click",e[23],!1,!1,!1)],p=!0)},p:function(e,t){32768&t[0]&&R(n,e[15]),524288&t[0]&&_(n,"hideDetails",e[19])},d:function(e){e&&ae(t),p=!1,s(m)}};return ce("SvelteRegisterBlock",{block:h,id:pt.name,type:"if",source:"(346:16) {#if receivedOffer && !$config.isManual}",ctx:e}),h}function mt(e){let t,n,o,c,r,a,l,u,d,f,p,m,h,g;const v={c:function(){t=b("div"),n=b("strong"),n.textContent="MANUAL OFFER HERE",o=k(),c=b("textarea"),r=k(),a=b("br"),l=k(),u=b("label"),d=y("3.\n                            "),f=b("button"),f.textContent="setRemoteDescription",p=k(),m=b("button"),m.textContent="create answer",i(n,ot,358,24,11689),ue(c,"cols","60"),ue(c,"rows","20"),ue(c,"class","svelte-2kh684"),i(c,ot,359,24,11748),i(a,ot,360,24,11832),i(f,ot,363,28,11930),i(m,ot,364,28,12045),i(u,ot,361,24,11863),i(t,ot,357,20,11659)},m:function(i,s){se(i,t,s),re(t,n),re(t,o),re(t,c),R(c,e[12]),re(t,r),re(t,a),re(t,l),re(t,u),re(u,d),re(u,f),re(u,p),re(u,m),h||(g=[le(c,"input",e[46]),le(f,"click",e[47],!1,!1,!1),le(m,"click",e[23],!1,!1,!1)],h=!0)},p:function(e,t){4096&t[0]&&R(c,e[12])},d:function(e){e&&ae(t),h=!1,s(g)}};return ce("SvelteRegisterBlock",{block:v,id:mt.name,type:"if",source:"(357:16) {#if $config.isManual}",ctx:e}),v}function ht(e){let t,n,o,c,r,a,l,u,d,f,p,m;const h={c:function(){t=b("div"),n=b("textarea"),o=k(),c=b("br"),r=k(),a=b("label"),l=y("4.\n                            "),u=b("button"),u.textContent="setLocalDescription",d=k(),f=b("button"),f.textContent="send answer",ue(n,"cols","60"),ue(n,"rows","20"),ue(n,"class","svelte-2kh684"),_(n,"hideDetails",e[19]),i(n,ot,370,24,12286),i(c,ot,371,24,12390),i(u,ot,374,28,12488),i(f,ot,375,28,12609),i(a,ot,372,24,12421),i(t,ot,369,20,12256)},m:function(i,s){se(i,t,s),re(t,n),R(n,e[11]),re(t,o),re(t,c),re(t,r),re(t,a),re(a,l),re(a,u),re(a,d),re(a,f),p||(m=[le(n,"input",e[48]),le(u,"click",e[49],!1,!1,!1),le(f,"click",e[25],!1,!1,!1)],p=!0)},p:function(e,t){2048&t[0]&&R(n,e[11]),524288&t[0]&&_(n,"hideDetails",e[19])},d:function(e){e&&ae(t),p=!1,s(m)}};return ce("SvelteRegisterBlock",{block:h,id:ht.name,type:"if",source:"(369:16) {#if localAnswerSdp && receivedOffer}",ctx:e}),h}function gt(e){let t,n,o;const c={c:function(){t=b("textarea"),ue(t,"cols","60"),ue(t,"rows","20"),ue(t,"class","svelte-2kh684"),_(t,"hideDetails",e[19]),i(t,ot,382,16,12841)},m:function(i,c){se(i,t,c),R(t,e[17]),n||(o=le(t,"input",e[50]),n=!0)},p:function(e,n){131072&n[0]&&R(t,e[17]),524288&n[0]&&_(t,"hideDetails",e[19])},d:function(e){e&&ae(t),n=!1,o()}};return ce("SvelteRegisterBlock",{block:c,id:gt.name,type:"if",source:"(382:12) {#if readableCandidates.length || $config.isManual}",ctx:e}),c}function vt(e){let t,n,o,c,r,s,a,l,u=JSON.stringify(e[18],null,4)+"";const d={c:function(){t=b("label"),t.textContent="injected Candidates",n=k(),o=b("textarea"),c=k(),r=b("pre"),s=y(u),ue(t,"for","injectedCandidates"),i(t,ot,386,16,12994),ue(o,"name","injectedCandidates"),ue(o,"cols","60"),ue(o,"rows","20"),ue(o,"class","svelte-2kh684"),i(o,ot,387,16,13070),i(r,ot,388,16,13177)},m:function(i,u){se(i,t,u),se(i,n,u),se(i,o,u),R(o,e[4]),se(i,c,u),se(i,r,u),re(r,s),a||(l=le(o,"input",e[51]),a=!0)},p:function(e,t){16&t[0]&&R(o,e[4]),262144&t[0]&&u!==(u=JSON.stringify(e[18],null,4)+"")&&de(s,u)},d:function(e){e&&ae(t),e&&ae(n),e&&ae(o),e&&ae(c),e&&ae(r),a=!1,l()}};return ce("SvelteRegisterBlock",{block:d,id:vt.name,type:"if",source:"(386:12) {#if $config.isManual}",ctx:e}),d}function $t(e){let t,n,o,c,r,a,l,u,d,f,p,m,h,g,v,$,w,S,C,x,R,_,O,E,j,D,M,B,A,P,N,L,U,T,I,F,q,J,V,H,W,z,Y,Z,ee,te,ne,oe,ie,fe=e[5].isRemote&&it(e),pe=e[5].hasUpstream&&ct(e),me=e[5].hasDownstream&&rt(e),he=!e[19]&&st(e),ge=e[0]&&at(e),ve=e[1]&&ft(e),$e=(e[17].length||e[5].isManual)&&gt(e),we=e[5].isManual&&vt(e);const be={c:function(){t=b("section"),n=b("h3"),o=y(e[2]),c=k(),fe&&fe.c(),r=k(),a=b("small"),l=y("talking to "),u=y(e[3]),d=k(),f=b("div"),pe&&pe.c(),p=k(),me&&me.c(),m=k(),h=b("div"),g=b("label"),v=y("signaling: "),$=b("code"),w=y(e[7]),S=k(),C=b("label"),x=y("connection: "),R=b("code"),_=y(e[8]),O=k(),E=b("label"),j=y("ice: "),D=b("code"),M=y(e[9]),B=k(),he&&he.c(),A=k(),P=b("fieldset"),N=b("span"),L=b("label"),U=b("input"),T=y(" caller"),I=k(),F=b("label"),q=b("input"),J=y(" receiver"),V=k(),H=b("label"),W=b("input"),z=y(" manual mode"),Y=k(),ge&&ge.c(),Z=k(),ve&&ve.c(),ee=k(),$e&&$e.c(),te=k(),we&&we.c(),i(n,ot,272,4,8088),i(a,ot,276,4,8180),ue($,"class","svelte-2kh684"),i($,ot,293,31,8743),i(g,ot,293,12,8724),ue(R,"class","svelte-2kh684"),i(R,ot,294,32,8814),i(C,ot,294,12,8794),ue(D,"class","svelte-2kh684"),i(D,ot,295,25,8879),i(E,ot,295,12,8866),ue(U,"type","checkbox"),i(U,ot,303,28,9093),i(L,ot,303,20,9085),ue(q,"type","checkbox"),i(q,ot,304,28,9187),i(F,ot,304,20,9179),ue(W,"type","checkbox"),i(W,ot,305,28,9285),i(H,ot,305,20,9277),ue(N,"class","svelte-2kh684"),i(N,ot,302,16,9058),ue(P,"class","svelte-2kh684"),i(P,ot,301,12,9031),ue(h,"id","signaling"),ue(h,"class","svelte-2kh684"),i(h,ot,292,8,8691),ue(f,"id","streams"),ue(f,"class","svelte-2kh684"),i(f,ot,277,4,8222),i(t,ot,270,0,8073)},l:function(e){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(i,s){se(i,t,s),re(t,n),re(n,o),re(t,c),fe&&fe.m(t,null),re(t,r),re(t,a),re(a,l),re(a,u),re(t,d),re(t,f),pe&&pe.m(f,null),re(f,p),me&&me.m(f,null),re(f,m),re(f,h),re(h,g),re(g,v),re(g,$),re($,w),re(h,S),re(h,C),re(C,x),re(C,R),re(R,_),re(h,O),re(h,E),re(E,j),re(E,D),re(D,M),re(h,B),he&&he.m(h,null),re(h,A),re(h,P),re(P,N),re(N,L),re(L,U),U.checked=e[0],re(L,T),re(N,I),re(N,F),re(F,q),q.checked=e[1],re(F,J),re(N,V),re(N,H),re(H,W),W.checked=e[5].isManual,re(H,z),re(h,Y),ge&&ge.m(h,null),re(h,Z),ve&&ve.m(h,null),re(h,ee),$e&&$e.m(h,null),re(h,te),we&&we.m(h,null),ne=!0,oe||(ie=[le(U,"change",e[35]),le(q,"change",e[36]),le(W,"change",e[37])],oe=!0)},p:function(e,n){(!ne||4&n[0])&&de(o,e[2]),e[5].isRemote?fe?(fe.p(e,n),32&n[0]&&Q(fe,1)):(fe=it(e),fe.c(),Q(fe,1),fe.m(t,r)):fe&&(G(),X(fe,1,1,()=>{fe=null}),K()),(!ne||8&n[0])&&de(u,e[3]),e[5].hasUpstream?pe?(pe.p(e,n),32&n[0]&&Q(pe,1)):(pe=ct(e),pe.c(),Q(pe,1),pe.m(f,p)):pe&&(G(),X(pe,1,1,()=>{pe=null}),K()),e[5].hasDownstream?me?me.p(e,n):(me=rt(e),me.c(),me.m(f,m)):me&&(me.d(1),me=null),(!ne||128&n[0])&&de(w,e[7]),(!ne||256&n[0])&&de(_,e[8]),(!ne||512&n[0])&&de(M,e[9]),e[19]?he&&(he.d(1),he=null):he?he.p(e,n):(he=st(e),he.c(),he.m(h,A)),1&n[0]&&(U.checked=e[0]),2&n[0]&&(q.checked=e[1]),32&n[0]&&(W.checked=e[5].isManual),e[0]?ge?ge.p(e,n):(ge=at(e),ge.c(),ge.m(h,Z)):ge&&(ge.d(1),ge=null),e[1]?ve?ve.p(e,n):(ve=ft(e),ve.c(),ve.m(h,ee)):ve&&(ve.d(1),ve=null),e[17].length||e[5].isManual?$e?$e.p(e,n):($e=gt(e),$e.c(),$e.m(h,te)):$e&&($e.d(1),$e=null),e[5].isManual?we?we.p(e,n):(we=vt(e),we.c(),we.m(h,null)):we&&(we.d(1),we=null)},i:function(e){ne||(Q(fe),Q(pe),ne=!0)},o:function(e){X(fe),X(pe),ne=!1},d:function(e){e&&ae(t),fe&&fe.d(),pe&&pe.d(),me&&me.d(),he&&he.d(),ge&&ge.d(),ve&&ve.d(),$e&&$e.d(),we&&we.d(),oe=!1,s(ie)}};return ce("SvelteRegisterBlock",{block:be,id:$t.name,type:"component",source:"",ctx:e}),be}function wt(e,t,n){let o,i,c,r,s,a,l,u,f,m,h;d(Se,"eventLogByName"),p(e,Se,e=>n(30,l=e)),d(xe,"offerStore"),p(e,xe,e=>n(31,u=e)),d(Re,"answerStore"),p(e,Re,e=>n(32,f=e)),d(ke,"config"),p(e,ke,e=>n(5,m=e)),d(_e,"candidatesStore"),p(e,_e,e=>n(54,h=e));let{$$slots:g={},$$scope:v}=t;pe("Participant",g,[]);let{isCaller:$=!1}=t,{isReceiver:w=!1}=t,{name:b="unnamed participant"}=t,{recipient:y=null}=t;const k=new Ie({from:b,to:y}),S=B(),C=Ce(b);let x,R,_,O="",E="",j="",D="",A="",N="",L="",U=[],T="",I="unified-plan"===new URL(document.location).searchParams.get("semantic")?{sdpSemantics:"unified-plan"}:{sdpSemantics:"plan-b"};function q(){I.sdpSemantics;const e=new RTCPeerConnection(I);return e.ontrack=e=>{const{track:t,streams:o,transceiver:i}=e,c=o[0];n(6,x.srcObject=c,x),c.onaddtrack=()=>console.warn(b+"track added to stream",{track:t,stream:c}),"video"==t.kind&&(console.info(b+".ontrack",{track:t,streams:o,kind:t.kind,transceiver:i}),t.onmute=e=>{console.info(b+" track onmute",{event:e}),n(6,x.srcObject=null,x)},t.onunmute=e=>{console.info(b+" track onunmute",{event:e}),n(6,x.srcObject=c,x)},t.onended=e=>{console.debug(b+" track onended",{event:e})})},e.onicecandidate=({candidate:e})=>{C("lc","create candidate"),n(29,U=[...U,e]),Y(e)},e.onsignalingstatechange=t=>n(7,O=e.signalingState),e.onconnectionstatechange=t=>n(8,E=e.connectionState),e.oniceconnectionstatechange=t=>n(9,j=e.iceConnectionState),console.info("setup RTCPeerConnection for "+b,I,e),e}function J(e){_?(C("rt","replace track"),console.info("replace track",{sender:_}),_.replaceTrack(e.getTracks()[0])):(C("at","add track"),console.info("add track"),_=R.addTrack(e.getTracks()[0],e))}async function V(){C("o","create offer");const e=await R.createOffer({offerToReceiveVideo:!0,offerToReceiveAudio:!1});n(10,D=e.sdp)}async function H(){C("a","create answer");const e=await R.createAnswer();n(11,A=e.sdp)}function W(){const e=Je(D);Oe({from:b,offer:e}),m.isRemote&&k.sendOffer(e)}function z(){const e=Je(A);Ee({from:b,answer:e}),m.isRemote&&k.sendAnswer(e)}function Y(e){b&&e&&(je({from:b,candidate:e}),m.isRemote&&k.sendCandidate(e))}async function G(e){C("l","setLocalDescription"),console.debug("localDescription ->",e);const t=e;De(b),R.setLocalDescription(t),Q(),De(y)}function K(e){C("r","setRemoteDescription");const t=Je(e);R.setRemoteDescription(t),Q(),De(y)}function Q(){m.isManual?(s||[]).forEach(e=>{e&&(C("ac","addIceCandidate"),R.addIceCandidate(e))}):(console.debug(h[y]),(h[y]||[]).forEach(e=>{e&&(C("ac","addIceCandidate"),R.addIceCandidate(e))}))}function X(e){C("r","setRemoteDescription");const t=Ve(e);R.setRemoteDescription(t),De(b)}M(()=>{R=q(),_e.subscribe(({[y]:e})=>{e&&C("rc")}),m.hasCaller&&V()});const Z=["isCaller","isReceiver","name","recipient"];Object.keys(t).forEach(e=>{~Z.indexOf(e)||"$$"===e.slice(0,2)||nt.warn(`<Participant> was created with unknown prop '${e}'`)});return e.$$set=e=>{"isCaller"in e&&n(0,$=e.isCaller),"isReceiver"in e&&n(1,w=e.isReceiver),"name"in e&&n(2,b=e.name),"recipient"in e&&n(3,y=e.recipient)},e.$capture_state=()=>({onMount:M,createEventDispatcher:B,tick:F,config:ke,addEventFor:Ce,eventLogByName:Se,offerStore:xe,answerStore:Re,candidatesStore:_e,sendOfferFrom:Oe,sendAnswerFrom:Ee,sendCandidateFrom:je,clearCandidatesFrom:De,SignalingClient:Ie,justTheSdp:Fe,safeParse:qe,packOffer:Je,packAnswer:Ve,Upstream:Qe,RemoteBar:tt,isCaller:$,isReceiver:w,name:b,recipient:y,signalingClient:k,dispatch:S,addEvent:C,downstreamVideo:x,peerConnection:R,sender:_,signalingState:O,connectionState:E,iceConnectionState:j,localOfferSdp:D,localAnswerSdp:A,injectedOffer:N,injectedAnswer:L,rawCandidates:U,injectedCandidates:T,pcconfig:I,initPeerConnection:q,addStream:J,createOffer:V,createAnswer:H,sendOffer:W,sendAnswer:z,sendCandidate:Y,applyLocal:G,applyRemoteOffer:K,applyCandidates:Q,applyRemoteAnswer:X,events:o,$eventLogByName:l,receivedOffer:i,$offerStore:u,receivedAnswer:c,$answerStore:f,readableCandidates:r,parsedInjectedCandidates:s,$config:m,$candidatesStore:h,hideDetails:a}),e.$inject_state=e=>{"isCaller"in e&&n(0,$=e.isCaller),"isReceiver"in e&&n(1,w=e.isReceiver),"name"in e&&n(2,b=e.name),"recipient"in e&&n(3,y=e.recipient),"downstreamVideo"in e&&n(6,x=e.downstreamVideo),"peerConnection"in e&&(R=e.peerConnection),"sender"in e&&(_=e.sender),"signalingState"in e&&n(7,O=e.signalingState),"connectionState"in e&&n(8,E=e.connectionState),"iceConnectionState"in e&&n(9,j=e.iceConnectionState),"localOfferSdp"in e&&n(10,D=e.localOfferSdp),"localAnswerSdp"in e&&n(11,A=e.localAnswerSdp),"injectedOffer"in e&&n(12,N=e.injectedOffer),"injectedAnswer"in e&&n(13,L=e.injectedAnswer),"rawCandidates"in e&&n(29,U=e.rawCandidates),"injectedCandidates"in e&&n(4,T=e.injectedCandidates),"pcconfig"in e&&(I=e.pcconfig),"events"in e&&n(14,o=e.events),"receivedOffer"in e&&n(15,i=e.receivedOffer),"receivedAnswer"in e&&n(16,c=e.receivedAnswer),"readableCandidates"in e&&n(17,r=e.readableCandidates),"parsedInjectedCandidates"in e&&n(18,s=e.parsedInjectedCandidates),"hideDetails"in e&&n(19,a=e.hideDetails)},t&&"$$inject"in t&&e.$inject_state(t.$$inject),e.$$.update=()=>{1073741828&e.$$.dirty[0]&&n(14,o=l[b]||[]),8&e.$$.dirty[0]|1&e.$$.dirty[1]&&n(15,i=Fe(u[y])),8&e.$$.dirty[0]|2&e.$$.dirty[1]&&n(16,c=Fe(f[y])),536870912&e.$$.dirty[0]&&n(17,r=JSON.stringify(U)),16&e.$$.dirty[0]&&n(18,s=qe(T)),32&e.$$.dirty[0]&&n(19,a=m.hideDetails)},[$,w,b,y,T,m,x,O,E,j,D,A,N,L,o,i,c,r,s,a,k,J,V,H,W,z,G,K,X,U,l,u,f,({detail:e})=>J(e),function(e){P[e?"unshift":"push"](()=>{x=e,n(6,x)})},function(){$=this.checked,n(0,$)},function(){w=this.checked,n(1,w)},function(){m.isManual=this.checked,ke.set(m)},function(){D=this.value,n(10,D)},()=>G(Je(D)),function(){c=this.value,n(16,c),n(32,f),n(3,y)},()=>X(c),function(){L=this.value,n(13,L)},()=>X(L),function(){i=this.value,n(15,i),n(31,u),n(3,y)},()=>K(i),function(){N=this.value,n(12,N)},()=>K(N),function(){A=this.value,n(11,A)},()=>G(Ve(A)),function(){r=this.value,n(17,r),n(29,U)},function(){T=this.value,n(4,T)}]}var bt=class extends me{constructor(e){super(e),ie(this,e,wt,$t,l,{isCaller:0,isReceiver:1,name:2,recipient:3},[-1,-1]),ce("SvelteRegisterComponent",{component:this,tagName:"Participant",options:e,id:$t.name})}get isCaller(){throw new Error("<Participant>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set isCaller(e){throw new Error("<Participant>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get isReceiver(){throw new Error("<Participant>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set isReceiver(e){throw new Error("<Participant>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get name(){throw new Error("<Participant>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set name(e){throw new Error("<Participant>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get recipient(){throw new Error("<Participant>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set recipient(e){throw new Error("<Participant>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}};function yt(e,t,n){const o=e.slice();return o[1]=t[n].name,o[2]=t[n].event,o}function kt(e){let t,n,o,c,r=e[1]+"",s=e[2]+"";const a={c:function(){t=b("li"),n=y(r),o=y(": "),c=y(s),i(t,"src/EventLog.svelte",6,8,146)},m:function(e,i){se(e,t,i),re(t,n),re(t,o),re(t,c)},p:function(e,t){1&t&&r!==(r=e[1]+"")&&de(n,r),1&t&&s!==(s=e[2]+"")&&de(c,s)},d:function(e){e&&ae(t)}};return ce("SvelteRegisterBlock",{block:a,id:kt.name,type:"each",source:"(6:4) {#each $eventLog.filter(e => e.event) as { name, event }}",ctx:e}),a}function St(e){let t,n,c,r,s,a=e[0].filter(Ct);fe(a);let l=[];for(let t=0;t<a.length;t+=1)l[t]=kt(yt(e,a,t));const u={c:function(){t=b("ol");for(let e=0;e<l.length;e+=1)l[e].c();n=k(),c=b("em"),r=y("please open\n    "),s=b("code"),s.textContent="chrome://webrtc-internals",i(t,"src/EventLog.svelte",4,0,71),i(s,"src/EventLog.svelte",12,4,215),i(c,"src/EventLog.svelte",10,0,190)},l:function(e){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(e,o){se(e,t,o);for(let e=0;e<l.length;e+=1)l[e].m(t,null);se(e,n,o),se(e,c,o),re(c,r),re(c,s)},p:function(e,[n]){if(1&n){let o;for(a=e[0].filter(Ct),fe(a),o=0;o<a.length;o+=1){const i=yt(e,a,o);l[o]?l[o].p(i,n):(l[o]=kt(i),l[o].c(),l[o].m(t,null))}for(;o<l.length;o+=1)l[o].d(1);l.length=a.length}},i:o,o:o,d:function(e){e&&ae(t),w(l,e),e&&ae(n),e&&ae(c)}};return ce("SvelteRegisterBlock",{block:u,id:St.name,type:"component",source:"",ctx:e}),u}const Ct=e=>e.event;function xt(e,t,n){let o;d($e,"eventLog"),p(e,$e,e=>n(0,o=e));let{$$slots:i={},$$scope:c}=t;pe("EventLog",i,[]);const r=[];return Object.keys(t).forEach(e=>{~r.indexOf(e)||"$$"===e.slice(0,2)||console.warn(`<EventLog> was created with unknown prop '${e}'`)}),e.$capture_state=()=>({config:ke,eventLog:$e,$eventLog:o}),[o]}var Rt=class extends me{constructor(e){super(e),ie(this,e,xt,St,l,{}),ce("SvelteRegisterComponent",{component:this,tagName:"EventLog",options:e,id:St.name})}};function _t(e){let t,n;t=new bt({props:{name:"alice",isCaller:"true",recipient:"bob"},$$inline:!0});const o={c:function(){te(t.$$.fragment)},m:function(e,o){ne(t,e,o),n=!0},i:function(e){n||(Q(t.$$.fragment,e),n=!0)},o:function(e){X(t.$$.fragment,e),n=!1},d:function(e){oe(t,e)}};return ce("SvelteRegisterBlock",{block:o,id:_t.name,type:"if",source:"(37:8) {#if $config.hasCaller}",ctx:e}),o}function Ot(e){let t,n;t=new bt({props:{name:"bob",isReceiver:"true",recipient:"alice"},$$inline:!0});const o={c:function(){te(t.$$.fragment)},m:function(e,o){ne(t,e,o),n=!0},i:function(e){n||(Q(t.$$.fragment,e),n=!0)},o:function(e){X(t.$$.fragment,e),n=!1},d:function(e){oe(t,e)}};return ce("SvelteRegisterBlock",{block:o,id:Ot.name,type:"if",source:"(41:8) {#if $config.hasReceiver}",ctx:e}),o}function Et(e){let t,n,o;n=new Rt({$$inline:!0});const c={c:function(){t=b("div"),te(n.$$.fragment),ue(t,"class","svelte-vvgboa"),i(t,"src/Demo.svelte",45,8,950)},m:function(e,i){se(e,t,i),ne(n,t,null),o=!0},i:function(e){o||(Q(n.$$.fragment,e),o=!0)},o:function(e){X(n.$$.fragment,e),o=!1},d:function(e){e&&ae(t),oe(n)}};return ce("SvelteRegisterBlock",{block:c,id:Et.name,type:"if",source:"(45:8) {#if !$config.hideDetails}",ctx:e}),c}function jt(e){let t,n,o,c,r,s,a,l;o=new Te({$$inline:!0});let u=e[0].hasCaller&&_t(e),d=e[0].hasReceiver&&Ot(e),f=!e[0].hideDetails&&Et(e);const p={c:function(){t=b("div"),n=b("aside"),te(o.$$.fragment),c=k(),r=b("section"),u&&u.c(),s=k(),d&&d.c(),a=k(),f&&f.c(),i(n,"src/Demo.svelte",30,4,618),ue(r,"class","svelte-vvgboa"),i(r,"src/Demo.svelte",34,4,662),ue(t,"class","svelte-vvgboa"),i(t,"src/Demo.svelte",29,0,608)},l:function(e){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(e,i){se(e,t,i),re(t,n),ne(o,n,null),re(t,c),re(t,r),u&&u.m(r,null),re(r,s),d&&d.m(r,null),re(r,a),f&&f.m(r,null),l=!0},p:function(e,[t]){e[0].hasCaller?u?1&t&&Q(u,1):(u=_t(e),u.c(),Q(u,1),u.m(r,s)):u&&(G(),X(u,1,1,()=>{u=null}),K()),e[0].hasReceiver?d?1&t&&Q(d,1):(d=Ot(e),d.c(),Q(d,1),d.m(r,a)):d&&(G(),X(d,1,1,()=>{d=null}),K()),e[0].hideDetails?f&&(G(),X(f,1,1,()=>{f=null}),K()):f?1&t&&Q(f,1):(f=Et(e),f.c(),Q(f,1),f.m(r,null))},i:function(e){l||(Q(o.$$.fragment,e),Q(u),Q(d),Q(f),l=!0)},o:function(e){X(o.$$.fragment,e),X(u),X(d),X(f),l=!1},d:function(e){e&&ae(t),oe(o),u&&u.d(),d&&d.d(),f&&f.d()}};return ce("SvelteRegisterBlock",{block:p,id:jt.name,type:"component",source:"",ctx:e}),p}function Dt(e,t,n){let o;d(ke,"config"),p(e,ke,e=>n(0,o=e));let{$$slots:i={},$$scope:c}=t;pe("Demo",i,[]);const r=[];return Object.keys(t).forEach(e=>{~r.indexOf(e)||"$$"===e.slice(0,2)||console.warn(`<Demo> was created with unknown prop '${e}'`)}),e.$capture_state=()=>({config:ke,offerStore:xe,answerStore:Re,candidatesStore:_e,Config:Te,Participant:bt,EventLog:Rt,$config:o}),[o]}var Mt=class extends me{constructor(e){super(e),ie(this,e,Dt,jt,l,{}),ce("SvelteRegisterComponent",{component:this,tagName:"Demo",options:e,id:jt.name})}};function Bt(e){let t,n;t=new Mt({$$inline:!0});const i={c:function(){te(t.$$.fragment)},l:function(e){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(e,o){ne(t,e,o),n=!0},p:o,i:function(e){n||(Q(t.$$.fragment,e),n=!0)},o:function(e){X(t.$$.fragment,e),n=!1},d:function(e){oe(t,e)}};return ce("SvelteRegisterBlock",{block:i,id:Bt.name,type:"component",source:"",ctx:e}),i}function At(e,t,n){let{$$slots:o={},$$scope:i}=t;pe("App",o,[]);const c=[];return Object.keys(t).forEach(e=>{~c.indexOf(e)||"$$"===e.slice(0,2)||console.warn(`<App> was created with unknown prop '${e}'`)}),e.$capture_state=()=>({Demo:Mt}),[]}const Pt=new class extends me{constructor(e){super(e),ie(this,e,At,Bt,l,{}),ce("SvelteRegisterComponent",{component:this,tagName:"App",options:e,id:Bt.name})}}({target:document.body,props:{}});window.app=Pt;t.default=Pt}]);